<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.w3.org/1999/xhtml"
      layout:decorator="layout">
  <head>
    <meta charset="ISO-8859-1"/>
    <meta charset="UTF-8"/>
    <meta th:name="csrf-token" th:content="${_csrf.token}" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" th:href="@{/css/stylish-portfolio.css}"/>
    <link rel="stylesheet" th:href="@{/css/animate.css}"/>
    <link rel="stylesheet" th:href="@{/css/theme.default.css}"/>
    <link rel="stylesheet" th:href="@{/css/view-admin-table.css}"/>
    <script type="text/javascript" th:src="@{/js/jquery.validate.js}"></script>
	<script th:src="@{/js/jquery-validation-tooltip.min.js}"></script>
    <script  th:src="@{/js/feedback-admin.js}"></script>
  </head>
  <body>
    <div layout:fragment="content">
      <div class="content">
		<p id="queryErrorMessage" th:text="#{admin.feedback.search.query.error}"  hidden="hidden"/>
        <h1 th:if="${feedbacks.size() != 0}" class="all text-right" th:text="#{ admin.feedback.count( ${feedbacks.size()} )}"/>
        <h1 th:if="${feedbacks.size() == 0}" class="all text-right" th:text="#{admin.feedback.list.empty}"/>
        
        <form class="form-inline" role="form" method="GET" 
              th:action="@{/admin/feedbacks/filter}" id="filterForm">
          <div class="form-group">
            <label class="filter-col" style="margin-right:0;" for="searchBy"
                   th:text="#{admin.feedback.search.title}"></label>
                   
            <select id="searchBy" name="criteria" class="form-control">
              <option value="producer" th:text="#{admin.feedback.search.producer}"></option>
              <option value="consumer" th:text="#{admin.feedback.search.consumer}"></option>
              <option value="message" th:text="#{admin.feedback.search.message}"></option>
            </select>
            
          </div>
          <div class="form-group">
            <input name="query" type="text" autocomplete="off"/>
          </div>
          <button type="submit" class="btn btn-default" id="searchButton"
                  th:text="#{admin.dashboard.users.show.search.search.button}"></button>
          <a    class="btn btn-default" id="clearButton" th:href="@{/admin/feedbacks}"
                  th:text="#{admin.dashboard.users.show.search.clear.button}"></a>
        </form>
        <table class="responstable" id="allUsers">
          <thead>
            <tr>
              <th th:inline="text">Message</th>
              <th th:inline="text">Producer</th>
              <th th:inline="text">Consumer</th>
              <th th:inline="text">Date</th>
              <th th:text="#{admin.feedback.actions}"/>
            </tr>
          </thead>

          <tbody th:with="iterStart=1">
            <tr  th:each="feedback:${feedbacks}">
              <td th:text="${feedback.message}"/>
              <td th:text="${feedback.producer.email}"/>
              <td th:text="${feedback.consumer.email}"/>
              <td th:text="${#temporals.format(feedback.date, 'dd/MMM/yyyy HH:mm')}"/>

              <td class="center">
                <span data-placement="top" data-toggle="tooltip"
                      th:title="#{admin.dashboard.users.show.title.tooltip.delete}" >
                  <a class="btn button_user" href="#"
                     th:onclick="'deleteWithModal(event)'" th:attr="data-id=${feedback.id}"
                     id="deleteFeedback" th:inline="text">
                    [[#{admin.feedback.actions.delete}]] <i class="glyphicon glyphicon-trash icon-white" ></i>
                  </a>

                </span>
                
              </td>
            </tr>
            <div class="modal fade" id="m_delete" role="dialog">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <div class="modal-header"
                           style="border-bottom: 1px solid #2FABE9">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title"
                            th:text="#{admin.feedback.actions.delete.title}"></h4>
                      </div>
                      <div class="modal-body" style="padding-bottom: 0">
                        <div class="alert alert-warning">
                          <p th:text="#{admin.feedback.actions.delete.item}"/>
                        </div>
                      </div>
                      <div class="modal-footer"
                           style="border-top: 1px solid #2FABE9">
                        <a id="deleteButton" class="btn btn-danger" type="submit"
                           th:text="#{admin.feedback.actions.delete.item.yes}"></a>
                        <button type="button" class="btn btn-default"
                                th:text="#{admin.feedback.actions.delete.item.no}"
                                data-dismiss="modal"></button>
                      </div>
                    </div>
                  </div>
                </div>
          </tbody>
        </table>
        <ul th:if="${pagination}" class="pagination pagination-lg">
							<li class="page-item" th:if="${currentPage != 1}"><a
								class="page-link" th:inline="text"
								th:href="@{|/admin/feedbacks/1|}">
									[[#{hospitals.list.page.first}]] </a></li>
							<li class="page-item" th:if="${currentPage != 1}"><a
								class="page-link"
								th:href="@{|/admin/feedbacks/${currentPage - 1}|}"
								aria-label="Previous"> <span aria-hidden="true">&laquo;</span>
									<span class="sr-only">Previous</span>
							</a></li>
							<li th:each="number:${#numbers.sequence(1,pageCount)}"
								th:class="page-item"
								th:classappend="${currentPage == number }?'active': ''"><a
								th:class="page-link"
								th:classappend="${currentPage == number }?'active': ''"
								th:href="@{|/admin/feedbacks/${number}|}" th:text="${number}" />
							</li>
							<li class="page-item" th:if="${(currentPage+1) &lt;= pageCount}">
								<a class="page-link"
								th:href="@{|/admin/feedbacks/${currentPage+1}|}" aria-label="Next">
									<span aria-hidden="true">&raquo;</span> <span class="sr-only">Next</span>
							</a>
							</li>
							<li class="page-item" th:if="${(currentPage+1) &lt;= pageCount}">
								<a class="page-link" th:href="@{|/admin/feedbacks/${pageCount}|}"
								th:inline="text"> [[#{hospitals.list.page.last}]] </a>
							</li>
						</ul>
      </div>
    </div>
  </body>
</html>
