<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.w3.org/1999/xhtml"
      layout:decorator="layout">
<meta charset="UTF-8"/>

<head lang="en">
    <title>Card</title>
</head>

<body>
<section layout:fragment="content">

    <div class="content">
        <div class="row">
            <div class="col-md-2"></div>

            <div class="col-md-8">
                <h1 th:text="#{card.full.name}+' '+ ${name}">Patient card:</h1>
                <a sec:authorize="hasRole('ROLE_DOCTOR')" th:href="@{/new/record(userId=${userId})}"
                   class="btn btn-info" style="display: inherit; margin-bottom: 12px;">New record</a>

                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                    <div th:if="${cardItems != null}" th:each="item:${cardItems.getPageList()}"
                         class="panel panel-default">
                        <div class="panel-heading" role="tab" id="headingOne">
                            <h4 class="panel-title">
                                <a class="collapsed" role="button"
                                   th:text="${#dates.format(item.date,'HH:mm dd-MM-yyyy')}" data-toggle="collapse"
                                   data-parent="#accordion2" th:href="${'#'+item.id}" aria-expanded="false"
                                   aria-controls="collapseOne">
                                </a>
                                <span th:text="#{card.full.doctor}+' '+${item.doctor.userDetails.firstName}+' '+${item.doctor.userDetails.lastName}"
                                      style="margin-left: 20px;">Doctor:</span>
                                <span sec:authorize="hasRole('ROLE_DOCTOR')" th:if="${item.doctor.email} == ${doctor}">
                                   <a th:if="${#dates.format(item.date,'dd-MM-yyyy')} == ${#dates.format(#dates.createNow(), 'dd-MM-yyyy')}"
                                   th:text="#{card.full.edit}"
                                   th:href="@{/edit(id=${item.id},userId=${userId})}" style="float:right">Edit</a></span>
                            </h4>
                        </div>
                        <div th:id="${item.id}" class="panel-collapse collapse" role="tabpanel"
                             aria-labelledby="headingOne">
                            <div class="panel-body">
                                <div id="item-dm">
                                    <h4>Complaint</h4>
                                    <pre class="well well-sm" th:text="${item.complaint}"></pre>
                                    <h4>Result</h4>
                                    <pre class="well well-sm" th:text="${item.result}"></pre>
                                    <h4>Prescription</h4>
                                    <pre class="well well-sm" th:text="${item.prescription}"></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12 text-center">
                    <div class="pagination pagination-centered">
                        <ul th:if="${pagination}" class="pagination">
                            <li th:each="i:${#numbers.sequence(1,cardItems.getPageCount())}" th:class="${i-1==cardItems.getPage()? 'active':''}"><a th:text="${i}"
                                                                                                                                                    th:href="@{/card/items/page(userId=${userId}, page=${i})}"></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-2"></div>
    </div>
</section>
</body>
</html>